<nz-layout>
  <div>
    <nz-tabset>
      <nz-tab [nzTitle]="'PROJECT.PROJECT_INFORMATION' | translate">
        @if (project) {
          <nz-descriptions nzBordered [nzColumn]="1" *ngIf="project">
            <nz-descriptions-item [nzTitle]="'GENERAL.TITLE' | translate">
              {{ project.title }}
            </nz-descriptions-item>
            <nz-descriptions-item [nzTitle]="'GENERAL.DESCRIPTION' | translate">
              <ng-template #descriptionTooltipTemp>
                <span class="ql-editor custom-tooltip" [innerHTML]="project.description | safeHtml"></span>
              </ng-template>
              <div
                class="ql-editor view-mode"
                style="max-width: 100%"
                [innerHTML]="project.description | safeHtml"
                nz-tooltip
                [nzTooltipTitle]="descriptionTooltipTemp"
              ></div>
            </nz-descriptions-item>
            <nz-descriptions-item [nzTitle]="'PROJECT.TYPE' | translate">
              {{ 'FORM.' + (project.type | uppercase) | translate }}
            </nz-descriptions-item>
            <nz-descriptions-item *ngIf="project.time_checkbox" [nzTitle]="'PROJECT.TIME_CHECKBOX' | translate">
              {{ 'RESULTS.BOOLEAN.' + (project.time_checkbox ? 'TRUE' : 'FALSE') | translate }}
            </nz-descriptions-item>
            <nz-descriptions-item *ngIf="project.deadline_checkbox" [nzTitle]="'PROJECT.DEADLINE_CHECKBOX' | translate">
              {{ 'RESULTS.BOOLEAN.' + (project.deadline_checkbox ? 'TRUE' : 'FALSE') | translate }}
            </nz-descriptions-item>
            <nz-descriptions-item *ngIf="project.time_limit" [nzTitle]="'GENERAL.TIME_LIMIT' | translate">
              {{ project.time_limit | date: DateFormat.TIME }}
            </nz-descriptions-item>
            <nz-descriptions-item *ngIf="project.deadline" [nzTitle]="'GENERAL.DEADLINE' | translate">
              {{ project.deadline | date: DateFormat.DATE }}
            </nz-descriptions-item>
            <nz-descriptions-item [nzTitle]="'GENERAL.CREATED' | translate">
              {{ project.created | date: DateFormat.DATE }}
            </nz-descriptions-item>
            <nz-descriptions-item [nzTitle]="'GENERAL.MODIFIED' | translate">
              {{ project.modified | date: DateFormat.DATE }}
            </nz-descriptions-item>
          </nz-descriptions>
        }
      </nz-tab>
      <nz-tab [nzTitle]="'PROJECT.SECTION_INPUTS' | translate">
        @if (project?.editList?.length) {
          <nz-descriptions nzBordered [nzColumn]="1" *ngIf="sectionInputStats">
            <nz-descriptions-item *ngIf="latestVersionNum" [nzTitle]="'VERSION' | translate">
              {{ latestVersionNum }}
            </nz-descriptions-item>

            <nz-descriptions-item [nzTitle]="'PROJECT.SECTION_INPUTS_STATISTICS' | translate">
              <ul class="statistics-list">
                <li *ngFor="let stat of sectionInputStats | keyvalue">{{ stat.key | translate }}: {{ stat.value }}</li>
              </ul>
            </nz-descriptions-item>
          </nz-descriptions>
        }
      </nz-tab>
      <nz-tab [nzTitle]="'PROJECT.PROJECT_JSON' | translate" class="json">
        <app-code-editor [mode]="CodeEditorMode.VIEW" [type]="CodeEditorType.JSON" [code]="this.project | json"></app-code-editor>
      </nz-tab>
      <nz-tab [nzTitle]="'PROJECT.PROJECT_HISTORY_JSON' | translate" class="json">
        <app-code-editor [mode]="CodeEditorMode.VIEW" [type]="CodeEditorType.JSON" [code]="this.projectHistory | json"></app-code-editor>
      </nz-tab>
    </nz-tabset>
    <div nz-row nzJustify="start" nzAlign="bottom" id="footerdiv">
      <div class="button-group">
        <button nz-button nzType="primary" type="button" (click)="nextPage()" class="saveBtn">
          {{ 'PROJECT.SAVE' | translate }}
        </button>
        <button
          nz-popconfirm
          [nzPopconfirmTitle]="'GENERAL.DOWNLOAD_CONFIRMATION' | translate"
          [nzCancelText]="'GENERAL.CANCEL' | translate"
          [nzOkText]="'GENERAL.OK' | translate"
          (nzOnConfirm)="saveProjectToJson()"
          nzPopconfirmPlacement="top"
          nz-button
          nzType="default"
          type="button"
        >
          {{ 'PROJECT.DOWNLOAD_PROJECT' | translate }}
        </button>
        <button
          nz-popconfirm
          [nzPopconfirmTitle]="'GENERAL.DOWNLOAD_CONFIRMATION' | translate"
          [nzCancelText]="'GENERAL.CANCEL' | translate"
          [nzOkText]="'GENERAL.OK' | translate"
          (nzOnConfirm)="saveProjectWithHistoryToJson()"
          nzPopconfirmPlacement="top"
          nz-button
          nzType="default"
          type="button"
        >
          {{ 'PROJECT.DOWNLOAD_PROJECT_WITH_HISTORY' | translate }}
        </button>
      </div>
    </div>
  </div>
</nz-layout>
